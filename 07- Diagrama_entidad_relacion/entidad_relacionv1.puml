@startuml
' Diagrama Entidad-Relación en notación Chen (PlantUML)
' Guardar como diagrama_ER_ventas_compras_chen.puml

hide circle
skinparam linetype ortho

' ENTIDADES
entity "Venta" as Venta {
  *venta_id : INT
  fecha : DATE
  hora : TIME
  descuento : FLOAT
  iva : FLOAT
  cantidad_total_productos : INT
  precio_total : FLOAT
}

entity "Item_Venta" as ItemVenta {
  *item_venta_id : INT
  nombre_producto : VARCHAR
  precio_unitario : FLOAT
  cantidad : INT
  subtotal : FLOAT
}

entity "Compra" as Compra {
  *compra_id : INT
  fecha : DATE
  hora : TIME
  iva : FLOAT
  cantidad_total_comprada : INT
  precio_total : FLOAT
}

entity "Item_Compra" as ItemCompra {
  *item_compra_id : INT
  nombre_producto : VARCHAR
  precio_unitario : FLOAT
  cantidad : INT
  subtotal : FLOAT
}

entity "Producto" as Producto {
  *producto_id : INT
  nombre : VARCHAR
  tipo : VARCHAR
  marca : VARCHAR
  precio_unitario : FLOAT
  cantidad : INT
}

entity "Stock" as Stock {
  *stock_id : INT
  precio_unitario : FLOAT
  cantidad : INT
  porcentaje_venta : FLOAT
}

entity "Historial_Precio" as HistPrecio {
  *hist_precio_id : INT
  precio_unitario : FLOAT
  fecha_inicio_vigencia : DATE
  fecha_fin_vigencia : DATE
}

entity "Historial_Movimiento" as HistMov {
  *mov_id : INT
  tipo_movimiento : ENUM(ingreso, egreso)
  referencia_tipo : VARCHAR
  referencia_id : INT
  fecha : DATE
  cantidad : INT
}

entity "Cliente" as Cliente {
  *cliente_id : INT
  nombre : VARCHAR
  apellido : VARCHAR
  plazo_de_pago : INT
  deuda : FLOAT
  forma_de_contacto : ENUM(Telefono, Email, Whatsapp)
}

entity "Pago" as Pago {
  *pago_id : INT
  fecha : DATE
  hora : TIME
  monto : FLOAT
  forma_de_pago : ENUM(Efectivo, Tarjeta, Transferencia)
}

entity "Proveedor" as Proveedor {
  *proveedor_id : INT
  CUIT : INT
  direccion : VARCHAR
  forma_de_contacto : ENUM(Telefono, Email, Whatsapp)
}

' RELACIONES COMO ENTIDADES (notación Chen: diamantes representados aquí como entidades separadas)
entity "R_Venta_Item" as R_Venta_Item {
  *rel_id : INT
  venta_id : INT <<FK>>
  item_venta_id : INT <<FK>>
}

entity "R_Compra_Item" as R_Compra_Item {
  *rel_id : INT
  compra_id : INT <<FK>>
  item_compra_id : INT <<FK>>
}

entity "R_Producto_Stock" as R_Producto_Stock {
  *rel_id : INT
  producto_id : INT <<FK>>
  stock_id : INT <<FK>>
}

entity "R_Producto_HistPrecio" as R_Producto_HistPrecio {
  *rel_id : INT
  producto_id : INT <<FK>>
  hist_precio_id : INT <<FK>>
}

entity "R_Producto_Mov" as R_Producto_Mov {
  *rel_id : INT
  producto_id : INT <<FK>>
  mov_id : INT <<FK>>
}

entity "R_Cliente_Compra" as R_Cliente_Compra {
  *rel_id : INT
  cliente_id : INT <<FK>>
  compra_id : INT <<FK>>
}

entity "R_Cliente_Pago" as R_Cliente_Pago {
  *rel_id : INT
  cliente_id : INT <<FK>>
  pago_id : INT <<FK>>
}

entity "R_Proveedor_Compra" as R_Proveedor_Compra {
  *rel_id : INT
  proveedor_id : INT <<FK>>
  compra_id : INT <<FK>>
}

' Conexiones (se indican cardinalidades mediante etiquetas; ajustar según necesidad)
Venta ||--o{ R_Venta_Item : "1..n"
R_Venta_Item }o--|| ItemVenta : "1"

Compra ||--o{ R_Compra_Item : "1..n"
R_Compra_Item }o--|| ItemCompra : "1"

Producto ||--o{ R_Producto_Stock : "1"
R_Producto_Stock }o--|| Stock : "1"

Producto ||--o{ R_Producto_HistPrecio : "1..n"
R_Producto_HistPrecio }o--|| HistPrecio : "1"

Producto ||--o{ R_Producto_Mov : "1..n"
R_Producto_Mov }o--|| HistMov : "1..n"

Cliente ||--o{ R_Cliente_Compra : "1..n"
R_Cliente_Compra }o--|| Compra : "1..n"

Cliente ||--o{ R_Cliente_Pago : "1..n"
R_Cliente_Pago }o--|| Pago : "1..n"

Proveedor ||--o{ R_Proveedor_Compra : "1..n"
R_Proveedor_Compra }o--|| Compra : "1..n"

' Notas: las "R_..." representan los diamantes/relaciones en Chen.
' Si preferís que las relaciones no tengan PKs propias (solo atributos), puedo mover los FK como atributos simples en las entidades de relación.

@enduml
