@startuml Gomeria

class Persona {
    - id: Int
    - nombre: String
    - cuit: String
    - direccion: String
    - telefono: String
    - email: String
    - creadoEn: Date
    - actualizadoEn: Date

    + getId(): Int
    + getNombre(): String
    + setNombre(String): Void
    + getCUIT(): String
    + setCUIT(String): Void
    + getContacto(): String
}

class Proveedor {
    - id: Int
    - codigo: String
    - listaPrecios: Map<String, Float>
    - activo: Boolean

    + registrarProveedor(): Void
    + modificarProveedor(): Void
    + eliminarProveedor(): Void
    + obtenerPrecios(): Map<String,Float>
}

class Cliente_antiguo {
    - id: Int
    - creditoMaximo: Float
    - deudaActual: Float
    - notas: String

    + registrarCliente(): Void
    + modificarCliente(): Void
    + eliminarCliente(): Void
    + getSaldo(): Float
    + registrarPago(Float): Void
}

class Producto {
    - id: Int
    - sku: String
    - nombre: String
    - descripcion: String
    - precioCosto: Float
    - precioVenta: Float
    - tipo: String
    - marca: String
    - stockDisponible: Int
    - stockMinimo: Int
    - unidadMedida: String

    + registrarProducto(): Void
    + modificarProducto(): Void
    + eliminarProducto(): Void
    + calcularPrecioVenta(porcentaje: Float): Float
    + ajustarStock(cantidad: Int, tipo: String): Void
    + getStock(): Int
}

class Item {
    - id: Int
    - productoId: Int
    - cantidad: Int
    - precioUnitario: Float
    - descuento: Float
    - subtotal: Float

    + calcularSubtotal(): Float
    + actualizarCantidad(Int): Void
}

class Transaccion {
    - id: Int
    - numero: String
    - fecha: Date
    - total: Float
    - estado: String       ' e.g. "ACTIVA", "ANULADA", "DADA_DE_BAJA"
    - formaPago: String
    - usuario: String
    - creadoEn: Date
    - actualizadoEn: Date
    - motivoBaja: String
    - usuarioBaja: String
    - fechaBaja: Date

    + procesar(): Void
    + calcularTotal(): Float
    + anular(motivo:String, usuario:String): Void
}

class Compra {
    - proveedorId: Int
    - fechaRecepcion: Date
    - numeroFactura: String
    - totalCompra: Float

    + registrarCompra(): Void
    + modificarCompra(): Void
    + eliminarCompra(): Void
    + darDeBaja(motivo:String, usuario:String): Void
}

class Venta {
    - clienteId: Int
    - fechaEntrega: Date
    - numeroComprobante: String
    - totalVenta: Float

    + registrarVenta(): Void
    + modificarVenta(): Void
    + eliminarVenta(): Void
    + emitirFactura(): Void
    + anularVenta(motivo:String, usuario:String): Void
}

class MovimientoStock {
    - id: Int
    - productoId: Int
    - cantidad: Int
    - tipo: String    ' "ENTRADA" | "SALIDA" | "BAJA"
    - referencia: String
    - fecha: Date
    - usuario: String

    + registrarMovimiento(): Void
}

' Herencias
Persona <|-- Cliente_antiguo
Persona <|-- Proveedor

' Transacciones
Transaccion <|-- Venta
Transaccion <|-- Compra

' Asociaciones y multiplicidades reales
Compra "1" --> "1..*" Item
Venta  "1" --> "1..*" Item
Item "1" --> "1" Producto

' Proveedor <-> Producto: relación muchos a muchos (un producto puede tener varios proveedores y viceversa)
Producto "0..*" -- "0..*" Proveedor : suministra

' Stock y movimientos
Producto "1" -- "0..*" MovimientoStock
MovimientoStock "0..1" --> "0..1" Transaccion : referencia_transaccion

' Relación entre compra/venta y terceros
Compra "1" --> "1" Proveedor
Venta "1" --> "1" Cliente_antiguo

' Notas de auditoría/estado en transacciones
note right of Transaccion
  Transaccion contiene campos para históricos:
  - motivoBaja, usuarioBaja, fechaBaja
  - estado permite distinguir activas/anuladas/dadas_de_baja
end note

@enduml